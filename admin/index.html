---
layout: page
title: Admin Panel - Quản lý Epub
permalink: /admin/
---

<link rel="stylesheet" href="../assets/css/epub-styles.css">
<style>
/* Ensure modals are visible */
.modal {
  display: none !important;
  position: fixed !important;
  z-index: 99999 !important;
  left: 0 !important;
  top: 0 !important;
  right: 0 !important;
  bottom: 0 !important;
  width: 100% !important;
  height: 100% !important;
  background-color: rgba(0, 0, 0, 0.5) !important;
  overflow-y: auto !important;
  opacity: 1 !important;
  transform: none !important;
}

.modal.show,
.modal[style*="display: block"] {
  display: block !important;
  opacity: 1 !important;
  transform: none !important;
}

.modal-content {
  background: white !important;
  margin: 2% auto !important;
  padding: 0 !important;
  border-radius: 12px !important;
  width: 95% !important;
  max-width: 900px !important;
  height: 90vh !important;
  max-height: 90vh !important;
  overflow: hidden !important;
  position: relative !important;
  box-shadow: 0 4px 20px rgba(0, 0, 0, 0.3) !important;
  display: flex !important;
  flex-direction: column !important;
}

.modal-header {
  background: linear-gradient(135deg, #007bff, #0056b3) !important;
  color: white !important;
  padding: 1rem 2rem !important;
  border-bottom: none !important;
  display: flex !important;
  justify-content: space-between !important;
  align-items: center !important;
  flex-shrink: 0 !important;
}

.modal-header h3 {
  color: white !important;
  margin: 0 !important;
  font-weight: 600 !important;
}

.modal-body {
  padding: 0 !important;
  background: white !important;
  color: #333 !important;
  flex: 1 !important;
  overflow: hidden !important;
  display: flex !important;
  flex-direction: column !important;
}

.close {
  font-size: 1.5rem !important;
  cursor: pointer !important;
  color: white !important;
  background: none !important;
  border: none !important;
  opacity: 0.8 !important;
  transition: opacity 0.3s ease !important;
}

.close:hover {
  color: white !important;
  opacity: 1 !important;
  transform: scale(1.1) !important;
}

/* Download buttons visibility */
.download-buttons {
  display: flex !important;
  flex-wrap: wrap !important;
  gap: 1rem !important;
  margin-bottom: 1rem !important;
}

.download-btn {
  display: flex !important;
  align-items: center !important;
  gap: 0.5rem !important;
  padding: 0.75rem 1.5rem !important;
  background: #28a745 !important;
  color: white !important;
  text-decoration: none !important;
  border-radius: 8px !important;
  font-weight: 600 !important;
  transition: all 0.3s ease !important;
}

.download-btn:hover {
  background: #218838 !important;
  transform: translateY(-2px) !important;
  box-shadow: 0 4px 12px rgba(40, 167, 69, 0.3) !important;
}

/* File Info Section - Fixed at top */
.file-info {
  background: linear-gradient(135deg, #28a745, #20c997) !important;
  color: white !important;
  padding: 1.5rem 2rem !important;
  border: none !important;
  box-shadow: 0 4px 15px rgba(40, 167, 69, 0.2) !important;
  flex-shrink: 0 !important;
  margin: 0 !important;
}

.file-info p {
  margin: 0.5rem 0 !important;
  color: white !important;
  font-weight: 500 !important;
}

.file-info strong {
  color: #fff !important;
  font-weight: 700 !important;
}

.file-info code {
  background: rgba(255, 255, 255, 0.2) !important;
  color: #fff !important;
  padding: 0.25rem 0.75rem !important;
  border-radius: 4px !important;
  font-family: 'Courier New', monospace !important;
  font-weight: 600 !important;
  border: 1px solid rgba(255, 255, 255, 0.3) !important;
}

/* Textarea Container - Scrollable area */
.textarea-container {
  flex: 1 !important;
  overflow-y: auto !important;
  padding: 2rem !important;
  background: white !important;
}

/* Textarea Styling */
#generatedMarkdown {
  width: 100% !important;
  min-height: 100% !important;
  height: auto !important;
  font-family: 'Courier New', monospace !important;
  font-size: 0.875rem !important;
  border: 2px solid #e9ecef !important;
  border-radius: 8px !important;
  padding: 1rem !important;
  resize: none !important;
  background: #f8f9fa !important;
  color: #333 !important;
  line-height: 1.5 !important;
  box-sizing: border-box !important;
}

#generatedMarkdown:focus {
  border-color: #007bff !important;
  outline: none !important;
  box-shadow: 0 0 0 3px rgba(0, 123, 255, 0.1) !important;
}

/* Modal Actions - Fixed at bottom */
.modal-actions {
  padding: 1.5rem 2rem !important;
  display: flex !important;
  gap: 1rem !important;
  justify-content: center !important;
  background: white !important;
  border-top: 1px solid #e9ecef !important;
  flex-shrink: 0 !important;
  margin: 0 !important;
}

.modal-actions .btn {
  padding: 0.75rem 2rem !important;
  border: none !important;
  border-radius: 8px !important;
  font-weight: 600 !important;
  cursor: pointer !important;
  transition: all 0.3s ease !important;
  text-decoration: none !important;
  display: inline-flex !important;
  align-items: center !important;
  gap: 0.5rem !important;
}

.modal-actions .btn-primary {
  background: linear-gradient(135deg, #007bff, #0056b3) !important;
  color: white !important;
}

.modal-actions .btn-primary:hover {
  background: linear-gradient(135deg, #0056b3, #004085) !important;
  transform: translateY(-2px) !important;
  box-shadow: 0 4px 15px rgba(0, 123, 255, 0.3) !important;
}

.modal-actions .btn-secondary {
  background: linear-gradient(135deg, #6c757d, #545b62) !important;
  color: white !important;
}

.modal-actions .btn-secondary:hover {
  background: linear-gradient(135deg, #545b62, #383d41) !important;
  transform: translateY(-2px) !important;
  box-shadow: 0 4px 15px rgba(108, 117, 125, 0.3) !important;
}

/* Preview Content Styling */
#previewContent {
  background: #f8f9fa !important;
  padding: 1.5rem !important;
  border-radius: 8px !important;
  border-left: 4px solid #007bff !important;
  color: #333 !important;
  line-height: 1.6 !important;
  font-size: 1rem !important;
}

#previewContent p {
  margin-bottom: 1rem !important;
  color: #333 !important;
}

#previewContent strong {
  color: #007bff !important;
}

#previewContent em {
  color: #6c757d !important;
  font-style: italic !important;
}
</style>

<div class="admin-panel">
  <div class="admin-header">
    <h1>Quản lý thư viện Epub</h1>
    <p>Thêm, sửa và quản lý các sách điện tử trong thư viện</p>
  </div>

  <!-- Navigation Tabs -->
  <div class="admin-tabs">
    <button class="tab-btn active" data-tab="add-book">Thêm sách mới</button>
    <button class="tab-btn" data-tab="manage-books">Quản lý sách</button>
    <button class="tab-btn" data-tab="settings">Cài đặt</button>
  </div>

  <!-- Add Book Tab -->
  <div class="tab-content active" id="add-book">
    <div class="form-container">
      <h2>Thêm sách mới</h2>
      <form id="addBookForm" class="book-form">
        <!-- Basic Information -->
        <div class="form-section">
          <h3>Thông tin cơ bản</h3>
          <div class="form-row">
            <div class="form-group">
              <label for="title">Tên sách *</label>
              <input type="text" id="title" name="title" required>
            </div>
            <div class="form-group">
              <label for="author">Tác giả *</label>
              <input type="text" id="author" name="author" required>
            </div>
          </div>
          
          <div class="form-row">
            <div class="form-group">
              <label for="isbn">ISBN</label>
              <input type="text" id="isbn" name="isbn" placeholder="978-xxx-xxx-xxx">
            </div>
            <div class="form-group">
              <label for="published_date">Ngày xuất bản</label>
              <input type="date" id="published_date" name="published_date">
            </div>
          </div>
          
          <div class="form-row">
            <div class="form-group">
              <label for="publisher">Nhà xuất bản</label>
              <input type="text" id="publisher" name="publisher">
            </div>
            <div class="form-group">
              <label for="language">Ngôn ngữ</label>
              <select id="language" name="language">
                <option value="Tiếng Việt">Tiếng Việt</option>
                <option value="English">English</option>
                <option value="中文">中文</option>
                <option value="日本語">日本語</option>
                <option value="한국어">한국어</option>
              </select>
            </div>
          </div>
          
          <div class="form-row">
            <div class="form-group">
              <label for="pages">Số trang</label>
              <input type="number" id="pages" name="pages" min="1">
            </div>
            <div class="form-group">
              <label for="rating">Đánh giá (1-5)</label>
              <input type="number" id="rating" name="rating" min="1" max="5" step="0.1">
            </div>
          </div>
        </div>

        <!-- Images -->
        <div class="form-section">
          <h3>Hình ảnh</h3>
          <div class="form-row">
            <div class="form-group">
              <label for="cover_image">URL ảnh bìa *</label>
              <input type="url" id="cover_image" name="cover_image" required placeholder="https://example.com/cover.jpg">
              <small>Upload ảnh lên S3 hoặc dịch vụ khác và dán link vào đây</small>
            </div>
            <div class="form-group">
              <label for="preview_image">URL ảnh preview</label>
              <input type="url" id="preview_image" name="preview_image" placeholder="https://example.com/preview.jpg">
              <small>Ảnh preview nội dung sách (tùy chọn)</small>
            </div>
          </div>
        </div>

        <!-- Genres -->
        <div class="form-section">
          <h3>Thể loại</h3>
          <div class="form-group">
            <label for="genres">Thể loại (phân cách bằng dấu phẩy)</label>
            <input type="text" id="genres" name="genres" placeholder="Văn học, Tiểu thuyết, Tình cảm">
            <small>Ví dụ: Văn học, Tiểu thuyết, Tình cảm</small>
          </div>
        </div>

        <!-- Description -->
        <div class="form-section">
          <h3>Mô tả và nội dung</h3>
          <div class="form-group">
            <label for="description">Mô tả sách *</label>
            <textarea id="description" name="description" rows="4" required placeholder="Mô tả ngắn gọn về nội dung cuốn sách..."></textarea>
          </div>
          
          <div class="form-group">
            <label for="preview_content">Nội dung preview *</label>
            <textarea id="preview_content" name="preview_content" rows="10" required placeholder="Nhập nội dung preview của sách (hỗ trợ Markdown)..."></textarea>
            <small>Hỗ trợ Markdown. Đây là phần nội dung người đọc có thể xem trước.</small>
          </div>
        </div>

        <!-- Download Links -->
        <div class="form-section">
          <h3>Link tải xuống</h3>
          <div id="downloadLinksContainer">
            <div class="download-link-item">
              <div class="form-row">
                <div class="form-group">
                  <label>Platform</label>
                  <select name="platform[]" required>
                    <option value="">Chọn platform</option>
                    <option value="Google Drive">Google Drive</option>
                    <option value="OneDrive">OneDrive</option>
                    <option value="Mega">Mega</option>
                    <option value="MediaFire">MediaFire</option>
                    <option value="Dropbox">Dropbox</option>
                    <option value="Other">Khác</option>
                  </select>
                </div>
                <div class="form-group">
                  <label>URL</label>
                  <input type="url" name="download_url[]" required placeholder="https://...">
                </div>
                <div class="form-group">
                  <label>Index</label>
                  <input type="number" name="download_index[]" min="0" required placeholder="0">
                </div>
                <div class="form-group">
                  <button type="button" class="btn-remove-link">Xóa</button>
                </div>
              </div>
            </div>
          </div>
          <button type="button" id="addDownloadLink" class="btn btn-secondary">Thêm link tải</button>
        </div>

        <!-- Config URL -->
        <div class="form-section">
          <h3>Cấu hình động</h3>
          <div class="form-group">
            <label for="config_url">URL cấu hình download</label>
            <input type="url" id="config_url" name="config_url" placeholder="https://api.example.com/config/book-id">
            <small>URL API để lấy cấu hình hiển thị link download (tùy chọn)</small>
          </div>
        </div>

        <!-- Tags -->
        <div class="form-section">
          <h3>Tags</h3>
          <div class="form-group">
            <label for="tags">Tags (phân cách bằng dấu phẩy)</label>
            <input type="text" id="tags" name="tags" placeholder="epub, văn học việt nam, bestseller">
            <small>Tags để SEO và tìm kiếm</small>
          </div>
        </div>

        <!-- Form Actions -->
        <div class="form-actions">
          <button type="button" id="previewBtn" class="btn btn-outline">Preview</button>
          <button type="submit" class="btn btn-primary">Tạo sách</button>
          <button type="button" id="resetBtn" class="btn btn-secondary">Reset form</button>
        </div>
      </form>
    </div>
  </div>

  <!-- Manage Books Tab -->
  <div class="tab-content" id="manage-books">
    <div class="manage-container">
      <h2>Quản lý sách hiện có</h2>
      <div class="books-list">
        <div class="search-bar">
          <input type="text" id="searchBooks" placeholder="Tìm kiếm sách...">
        </div>
        <div id="booksList" class="books-grid">
          <!-- Books will be loaded here -->
        </div>
      </div>
    </div>
  </div>

  <!-- Settings Tab -->
  <div class="tab-content" id="settings">
    <div class="settings-container">
      <h2>Cài đặt</h2>
      <div class="settings-section">
        <h3>Cấu hình chung</h3>
        <div class="form-group">
          <label for="defaultConfigUrl">URL cấu hình mặc định</label>
          <input type="url" id="defaultConfigUrl" placeholder="https://api.example.com/config/">
        </div>
        <div class="form-group">
          <label for="defaultImageHost">Host ảnh mặc định</label>
          <input type="text" id="defaultImageHost" placeholder="https://your-s3-bucket.com/">
        </div>
      </div>
    </div>
  </div>

  <!-- Preview Modal -->
  <div id="previewModal" class="modal">
    <div class="modal-content">
      <div class="modal-header">
        <h3>Preview Markdown</h3>
        <span class="close">&times;</span>
      </div>
      <div class="modal-body">
        <div id="previewContent"></div>
      </div>
    </div>
  </div>

  <!-- Generated Markdown Modal -->
  <div id="markdownModal" class="modal">
    <div class="modal-content">
      <div class="modal-header">
        <h3>Generated Markdown File</h3>
        <span class="close">&times;</span>
      </div>
      <div class="modal-body">
        <div class="file-info">
          <p><strong>Filename:</strong> <span id="generatedFilename"></span></p>
          <p><strong>Path:</strong> <code>_epubs/<span id="generatedPath"></span></code></p>
        </div>
        <div class="textarea-container">
          <textarea id="generatedMarkdown" readonly></textarea>
        </div>
        <div class="modal-actions">
          <button id="copyMarkdown" class="btn btn-primary">Copy to Clipboard</button>
          <button id="downloadMarkdown" class="btn btn-secondary">Download File</button>
        </div>
      </div>
    </div>
  </div>
</div>

<script src="/admin/admin.js"></script>
